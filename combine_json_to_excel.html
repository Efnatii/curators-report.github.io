            <div class="field">
              <span class="field__label">Добавьте JSON-файлы</span>
              <div class="file-picker-grid">
                <label class="file-picker">
                  <input id="jsonFiles" type="file" accept="application/json" multiple class="file-input" />
                  <div class="file-picker__control" aria-hidden="true">
                    <span class="file-picker__button">Выбрать файлы</span>
                    <span class="file-picker__hint">Можно выбрать несколько JSON одновременно</span>
                  </div>
                </label>

                <label class="file-picker">
                  <input id="jsonFolder" type="file" accept="application/json" webkitdirectory class="file-input" />
                  <div class="file-picker__control" aria-hidden="true">
                    <span class="file-picker__button">Выбрать папку</span>
                    <span class="file-picker__hint">Импорт всех JSON-файлов из каталога</span>
                  </div>
                </label>
              <div class="file-picker__status" id="fileCount">Файлы не выбраны</div>
            </div>
        const combineBtn = document.getElementById("combineBtn");
        const fileInput = document.getElementById("jsonFiles");
        const folderInput = document.getElementById("jsonFolder");
        const fileCount = document.getElementById("fileCount");
        const pdfCheckbox = document.getElementById("generatePdfs");

        combineBtn.disabled = true;

        const pluralizeFiles = (count) => {
          const mod10 = count % 10;
          const mod100 = count % 100;
          if (mod10 === 1 && mod100 !== 11) return "файл";
          if ([2, 3, 4].includes(mod10) && ![12, 13, 14].includes(mod100)) return "файла";
          return "файлов";
        };

        const getSelectedJsonFiles = () =>
          [...fileInput.files, ...folderInput.files].filter((file) =>
            file.name.toLowerCase().endsWith(".json")
          );

        const refreshFileCount = () => {
          const files = getSelectedJsonFiles();
          if (!files.length) {
            fileCount.textContent = "Файлы не выбраны";
            return;
          }
          fileCount.textContent = `Выбрано ${files.length} ${pluralizeFiles(files.length)}`;
        };
        fileInput.addEventListener("change", refreshFileCount);
        folderInput.addEventListener("change", refreshFileCount);
        refreshFileCount();
        const bootstrap = async () => {
          setStatus("Загружаем библиотеки…");
          await loadXlsxLibrary();
          await loadLibrary("jsPDF", [
            "https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js",
            "https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js",
          ]);
          setStatus("Ожидание файлов…");
          combineBtn.disabled = false;
        };
        await bootstrap();
        combineBtn.addEventListener("click", async () => {
          const files = getSelectedJsonFiles();
          if (!files || !files.length) {
            setStatus("Сначала выберите хотя бы один JSON-файл", true);
            return;
          }
          combineBtn.disabled = true;
          setStatus("Обработка файлов… это может занять немного времени.");

          try {
