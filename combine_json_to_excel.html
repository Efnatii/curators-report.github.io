              <span class="field__label">Выберите JSON-файлы:</span>
              <div class="file-picker file-picker--choices">
                <div class="file-picker__row">
                  <label class="file-picker__control file-picker__control--button">
                    <input id="jsonFiles" type="file" accept="application/json" multiple class="file-input" />
                    <span class="file-picker__button">Выбрать файлы</span>
                    <span class="file-picker__hint">Добавьте один или несколько JSON</span>
                  </label>
                  <label class="file-picker__control file-picker__control--button">
                    <input id="jsonFolder" type="file" accept="application/json" webkitdirectory directory class="file-input" />
                    <span class="file-picker__button">Выбрать папку</span>
                    <span class="file-picker__hint">Импортировать все JSON из каталога</span>
                  </label>
                <div class="file-picker__counter" id="fileCounter">Файлы не выбраны</div>
      const folderInput = document.getElementById("jsonFolder");
      const fileCounter = document.getElementById("fileCounter");
      let selectedFiles = [];

      const getSelectedFiles = () => {
        const rawFiles = [
          ...Array.from(fileInput?.files || []),
          ...Array.from(folderInput?.files || []),
        ].filter((file) => file.name.toLowerCase().endsWith(".json"));

        const unique = [];
        const seen = new Set();

        rawFiles.forEach((file) => {
          const key = file.webkitRelativePath || file.name;
          if (seen.has(key)) return;
          seen.add(key);
          unique.push(file);
        });

        return unique;
      };

      const describeCount = (count) => {
        if (count % 10 === 1 && count % 100 !== 11) return `${count} файл`;
        if ([2, 3, 4].includes(count % 10) && ![12, 13, 14].includes(count % 100)) return `${count} файла`;
        return `${count} файлов`;
      };

      const updateSelectionState = () => {
        selectedFiles = getSelectedFiles();

        if (!selectedFiles.length) {
          fileCounter.textContent = "Файлы не выбраны";
          combineBtn.disabled = true;
          return;
        }

        const fileSelectionCount = Array.from(fileInput?.files || []).filter((file) =>
          file.name.toLowerCase().endsWith(".json")
        ).length;
        const folderSelectionCount = Array.from(folderInput?.files || []).filter((file) =>
          file.name.toLowerCase().endsWith(".json")
        ).length;

        const breakdown = [];
        if (fileSelectionCount) breakdown.push(`${describeCount(fileSelectionCount)} через выбор файлов`);
        if (folderSelectionCount) breakdown.push(`${describeCount(folderSelectionCount)} из папки`);

        const suffix = breakdown.length ? ` (${breakdown.join(" + ")})` : "";

        fileCounter.textContent = `Выбрано ${describeCount(selectedFiles.length)}${suffix}`;
        combineBtn.disabled = false;
      };

      fileInput.addEventListener("change", updateSelectionState);
      folderInput.addEventListener("change", updateSelectionState);

        updateSelectionState();
        const files = selectedFiles;
